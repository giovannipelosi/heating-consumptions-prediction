% main run script

%% OPTIONS
nets_options = {};

options_1 = trainingOptions('sgdm', ...
    'MaxEpochs',220, ...
    'GradientThreshold',1, ...
    'InitialLearnRate',0.005, ...
    'LearnRateSchedule','piecewise', ...
    'LearnRateDropPeriod',125, ...
    'LearnRateDropFactor',0.2, ...
    'MiniBatchSize', 40,...
    'Verbose',0 );
nets_options{end + 1} = options_1;


options_2 = trainingOptions('adam', ...
    'MaxEpochs',220, ...
    'GradientThreshold',0.95, ...
    'InitialLearnRate',0.05, ...
    'LearnRateSchedule','piecewise', ...
    'LearnRateDropPeriod',70, ...
    'LearnRateDropFactor',0.3, ...
    'MiniBatchSize', 40,...
    'SquaredGradientDecayFactor',0.95,...
    'L2Regularization',0.0001,...
    'Verbose',0 );
nets_options{end + 1} = options_2;


options_3 = trainingOptions('rmsprop', ...
    'MaxEpochs',250, ...
    'GradientThreshold',1, ...
    'InitialLearnRate',0.005, ...
    'LearnRateSchedule','piecewise', ...
    'LearnRateDropPeriod',100, ...
    'LearnRateDropFactor',0.3, ...
    'MiniBatchSize', 40,...
    'Verbose',0 );
nets_options{end + 1} = options_3;


%% compute
 train_net('5', [1:2],  [1:3], [1:28], nets_options);